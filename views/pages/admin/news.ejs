<%- include('../../partials/header') %>

<main class="admin-news">
    <h1 class="admin-news__title">Управление новостями</h1>

    <div class="admin-news__controls">
        <button id="show-add-form" class="btn-control">Добавить новость</button>
        <button id="show-edit-list" class="btn-control">Редактировать</button>
        <button id="show-delete-list" class="btn-control">Удалить</button>
    </div>

    <section id="news-unified-list" class="admin-news__list">
        <h2 class="admin-news__subtitle">Список новостей</h2>
        <form id="deleteForm">
            <% news.forEach(n => { %>
                <div class="news-card" data-id="<%= n.id %>">
                    <h3 class="news-card__title"><%= n.title %></h3>
                    <p class="news-card__excerpt"><%= n.content.slice(0, 100) %>...</p>
                    <div class="news-card__actions">
                        <button type="button" class="edit-btn btn-secondary" style="display:none;">Редактировать</button>
                        <label class="delete-checkbox" style="display:none;">
                            <input type="checkbox" name="delete_ids[]" value="<%= n.id %>"> Удалить
                        </label>
                    </div>
                </div>
            <% }) %>
            <button id="deleteButton" type="submit" class="btn-danger" style="display:none;">Удалить выбранные</button>
        </form>
    </section>

    <section id="edit-form-container" class="admin-news__edit" style="display:none;">
        <h2>Редактировать новость</h2>
        <form id="editNewsForm" class="form-news">
            <input type="hidden" name="id" id="edit-id" />
            <input name="title" id="edit-title" placeholder="Заголовок" required />
            <textarea name="content" id="edit-content" placeholder="Содержание" required></textarea>
            <input name="image_url" id="edit-image" placeholder="Ссылка на изображение" required />
            <div class="form-news__actions">
                <button type="submit" class="cta__button">Сохранить</button>
                <button type="button" id="edit-cancel" class="btn-secondary">Отмена</button>
            </div>
        </form>
    </section>

    <section id="add-form" class="admin-news__add" style="display:none;">
        <h2>Добавить новость</h2>
        <form id="addNewsForm" class="form-news">
            <input name="title" placeholder="Заголовок" required />
            <textarea name="content" placeholder="Содержание" required></textarea>
            <input name="image_url" placeholder="Ссылка на изображение" required />
            <button type="submit" class="cta__button">Добавить</button>
        </form>
    </section>
</main>

<script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
<script src="/js/admin-news.js"></script>

<%- include('../../partials/footer') %>
